** 测试环境：win10系统  cpu 4核8线程 内存8g 测试工具SuperBenchmarker**

** 测试服务对象为本机：** gateway-server-0.0.1-SNAPSHOT.jar


C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 1 -N 10

Starting at 2021-3-25 11:07:38

[Press C to stop the test]

27847   (RPS: 1901.7)

---------------Finished!----------------

Finished at 2021-3-25 11:07:53 (took 00:00:14.6912016)

Status 200:    27847

RPS: 2524 (requests/second)

Max: 27ms

Min: 0ms

Avg: 0ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 0ms

99%   below 0ms

99.9%   below 2ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 2 -N 10

Starting at 2021-3-25 11:10:02

[Press C to stop the test]

51557   (RPS: 3537.4)

---------------Finished!----------------

Finished at 2021-3-25 11:10:16 (took 00:00:14.6245935)

Status 200:    51557

RPS: 4672.7 (requests/second)

Max: 28ms

Min: 0ms

Avg: 0ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 0ms

99%   below 0ms

99.9%   below 1ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 3 -N 10

Starting at 2021-3-25 11:11:18

[Press C to stop the test]

64474   (RPS: 4421.8)

---------------Finished!----------------

Finished at 2021-3-25 11:11:33 (took 00:00:14.6380303)

Status 200:    64475

RPS: 5841 (requests/second)

Max: 34ms

Min: 0ms

Avg: 0ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 0ms

99%   below 1ms

99.9%   below 2ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 4 -N 10

Starting at 2021-3-25 11:11:49

[Press C to stop the test]

66965   (RPS: 4405.6)

---------------Finished!----------------

Finished at 2021-3-25 11:12:04 (took 00:00:15.2585587)

Status 200:    66965

RPS: 6065.1 (requests/second)

Max: 34ms

Min: 0ms

Avg: 0ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 1ms

99%   below 1ms

99.9%   below 3ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 5 -N 10

Starting at 2021-3-25 11:12:34

[Press C to stop the test]

72444   (RPS: 4933.2)

---------------Finished!----------------

Finished at 2021-3-25 11:12:49 (took 00:00:14.7397298)

Status 200:    72444

RPS: 6559.4 (requests/second)

Max: 34ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 1ms

99%   below 1ms

99.9%   below 4ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 6 -N 10

Starting at 2021-3-25 11:13:10

[Press C to stop the test]

75134   (RPS: 5201.4)

---------------Finished!----------------

Finished at 2021-3-25 11:13:25 (took 00:00:14.4961132)

Status 200:    75134

RPS: 6804.9 (requests/second)

Max: 32ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 1ms

99%   below 1ms

99.9%   below 4ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 7 -N 10

Starting at 2021-3-25 11:13:41

[Press C to stop the test]

76161   (RPS: 5252.1)

---------------Finished!----------------

Finished at 2021-3-25 11:13:56 (took 00:00:14.5548169)

Status 200:    76162

RPS: 6898.7 (requests/second)

Max: 31ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 1ms

99%   below 1ms

99.9%   below 4ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 8 -N 10

Starting at 2021-3-25 11:14:14

[Press C to stop the test]

73183   (RPS: 5002.6)

---------------Finished!----------------

Finished at 2021-3-25 11:14:28 (took 00:00:14.6930585)

Status 200:    73183

RPS: 6623.6 (requests/second)

Max: 42ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 1ms

99%   below 2ms

99.9%   below 6ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 9 -N 10

Starting at 2021-3-25 11:15:19

[Press C to stop the test]

74912   (RPS: 5137.6)

---------------Finished!----------------

Finished at 2021-3-25 11:15:34 (took 00:00:14.6370671)

Status 200:    74912

RPS: 6783.2 (requests/second)

Max: 35ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 1ms

99%   below 2ms

99.9%   below 5ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 10 -N 10

Starting at 2021-3-25 11:15:45

[Press C to stop the test]

73854   (RPS: 5066.1)

---------------Finished!----------------

Finished at 2021-3-25 11:16:00 (took 00:00:14.6489682)

Status 200:    73857

RPS: 6681.9 (requests/second)

Max: 43ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 1ms

99%   below 2ms

99.9%   below 7ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 11 -N 10

Starting at 2021-3-25 11:16:07

[Press C to stop the test]

73252   (RPS: 5028.6)

---------------Finished!----------------

Finished at 2021-3-25 11:16:22 (took 00:00:14.6288861)

Status 200:    73252

RPS: 6629.3 (requests/second)

Max: 47ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 1ms

98%   below 2ms

99%   below 2ms

99.9%   below 7ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 12 -N 10

Starting at 2021-3-25 11:16:31

[Press C to stop the test]

72888   (RPS: 4994.7)

---------------Finished!----------------

Finished at 2021-3-25 11:16:45 (took 00:00:14.6567817)

Status 200:    72888

RPS: 6598.6 (requests/second)

Max: 71ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 1ms

98%   below 2ms

99%   below 3ms

99.9%   below 9ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 13 -N 10

Starting at 2021-3-25 11:17:06

[Press C to stop the test]

72096   (RPS: 4949.3)

---------------Finished!----------------

Finished at 2021-3-25 11:17:21 (took 00:00:14.6253644)

Status 200:    72096

RPS: 6528.6 (requests/second)

Max: 43ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 1ms

98%   below 2ms

99%   below 3ms

99.9%   below 7ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 14 -N 10

Starting at 2021-3-25 11:17:28

[Press C to stop the test]

71284   (RPS: 4918.2)

---------------Finished!----------------

Finished at 2021-3-25 11:17:42 (took 00:00:14.5587342)

Status 200:    71284

RPS: 6449.3 (requests/second)

Max: 47ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 1ms

98%   below 2ms

99%   below 3ms

99.9%   below 7ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 15 -N 10

Starting at 2021-3-25 11:17:50

[Press C to stop the test]

69992   (RPS: 4816.4)

---------------Finished!----------------

Finished at 2021-3-25 11:18:05 (took 00:00:14.5945395)

Status 200:    69993

RPS: 6335.9 (requests/second)

Max: 51ms

Min: 0ms

Avg: 0.2ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 1ms

98%   below 2ms

99%   below 4ms

99.9%   below 8ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 20 -N 10

Starting at 2021-3-25 11:18:12

[Press C to stop the test]

68589   (RPS: 4702.1)

---------------Finished!----------------

Finished at 2021-3-25 11:18:26 (took 00:00:14.6507861)

Status 200:    68592

RPS: 6209.6 (requests/second)

Max: 43ms

Min: 0ms

Avg: 0.1ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 0ms

98%   below 2ms

99%   below 3ms

99.9%   below 11ms

C:\Users\yins>sb -u[http://127.0.0.1:8088/api/hello](http://127.0.0.1:8088/api/hello?fileGuid=YYYWkGX9kgQR6rxd)-c 32 -N 10

Starting at 2021-3-25 11:19:12

[Press C to stop the test]

63954   (RPS: 4391.8)

---------------Finished!----------------

Finished at 2021-3-25 11:19:26 (took 00:00:14.6534515)

Status 200:    63955

RPS: 5770.7 (requests/second)

Max: 65ms

Min: 0ms

Avg: 0.3ms

50%   below 0ms

60%   below 0ms

70%   below 0ms

80%   below 0ms

90%   below 0ms

95%   below 2ms

98%   below 5ms

99%   below 7ms

99.9%   below 17ms

**总结：进行sb压测，并发数设置为7的时候，RPS值最大: 6898.7 (requests/second)**
# 
# 

**压测**

**压测是什么？**

压测，即压力测试，是确立系统稳定性的一种测试方法，通常在系统正常运作范围之外进行，以考察其功能极限和隐患。

主要检测服务器的承受能力，包括用户承受能力（多少用户同时请求基本不影响质量）、流量承受等。

**为什么要压测？**

压测的目的就是通过压测（模拟真实用户的行为），测算出机器的性能（单台机器的QPS），从而推算出系统在承受指定用户数（100w），需要多少机器能支撑的住

压测是在上线前为了应对未来可能达到的用户数量的一次预估（提前演练），压测以后通过优化程序的性能或准备充足的机器，来保证用户的体验。

# 压测名词解释

**压测类型解释**

|**压测类型**|**解释**|
|-----|-----|
|压力测试(Stress Testing)|也称之为强度测试，测试一个系统的最大抗压能力，在强负载(大数据、高并发)的情况下，测试系统所能承受的最大压力，预估系统的瓶颈|
|并发测试(Concurrency Testing)|通过模拟很多用户同一时刻访问系统或对系统某一个功能进行操作，来测试系统的性能，从中发现问题(并发读写、线程控制、资源争抢)|
|耐久性测试(Configuration Testing)|通过对系统在大负荷的条件下长时间运行，测试系统、机器的长时间运行下的状况,从中发现问题(内存泄漏、数据库连接池不释放、资源不回收)|

**压测名词解释**

|**压测名词**|**解释**|
|-----|-----|
|并发（Concurrency）|指一个处理器同时处理多个任务的能力（逻辑）|
|并行（Parallel）|多个处理器或多核处理器同时处理多个任务的能力（物理）|
|QPS（每秒查询数量Query Per Second）|服务器每秒处理请求数量（req/sec）|
|事务（Transactions）|用户一次或几次请求的集合|
|TPS（每秒处理事务数量 Transaction Per Second）|服务器每秒处理事务数量（一个事务可能包含多个请求）|
|请求成功数（Request Success Number）|一次压测中，请求成功数量|
|请求失败数（Request Failures Number）|一次压测中压请求失败数量缩|
|错误率（Error Rate）|在压测中，请求成功的数量与失败数量的比率|
|最大响应时间（Max Response Time）|在一次事务中，从发出请求或指令系统做出的反映（响应）的最大时间|
|最少响应时间（Mininum Response Time）|在一次事务中，从发出请求或指令系统做出的反映（响应）的最少时间|
|平均响应时间（Average Response Time）|在一次事务中，从发出请求或指令系统做出的反映（响应）的平均时间|

**机器性能指标解释**

|**机器性能**|**解释**|
|-----|-----|
|CPU利用率（CPU Usage）|CPU利用率分用户态、系统态和空闲态，CPU利用率是指：CPU执行非系统空闲进程的时间与CPU总执行时间的比率|
|内存使用率（Memory Usage）|内存使用率指的是此进程所使用的内存|
|IO（Disk input/output）|磁盘的读写包速率|
|网卡负载（Network Load）|网卡的进出带宽，数据包量|

**访问指标解释**

|**访问**|**解释**|
|-----|-----|
|PV（页面浏览量Page View）|用户每打开1个网站页面，记录1个PV。用户多次打开同一页面，PV值累计多次|
|UV（网站独立访客 Unique Visitor）|通过互联网访问、流量网站的自然人。1天内相同访客多次访问网站，只计算为1个独立访客|

**如何计算压测指标**

* 压测我们需要有目的性的压测，这次压测我们需要达到什么目标(如:单台机器的性能为100QPS?网站能同时满足100W人同时在线)
* 可以通过以下计算方法来进行计算:
* 压测原则:每天80%的访问量集中在20%的时间里，这20%的时间就叫做峰值
* 公式: ( 总PV数*80% ) / ( 每天的秒数*20% ) = 峰值时间每秒钟请求数(QPS)
* 机器: 峰值时间每秒钟请求数(QPS) / 单台机器的QPS = 需要的机器的数量
* 假设:网站每天的用户数(100W)，每天的用户的访问量约为3000W PV，这台机器的需要多少QPS?
>`( 30000000*0.8 ) / (86400 * 0.2) ≈ 1389 (QPS)`
* 假设:单台机器的的QPS是69，需要需要多少台机器来支撑？
>`1389 / 69 ≈ 20`



